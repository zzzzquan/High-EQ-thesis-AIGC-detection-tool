const isDetailReport=typeof isHasDetailReport=="boolean"?isHasDetailReport:false;const isAIReport=typeof isHasAIReport=="boolean"?isHasAIReport:false;const isProofReport=typeof isHasProofReport=="boolean"?isHasProofReport:false;const isHasDoubleRowWord=typeof is_has_double_row_word=="boolean"?is_has_double_row_word:false;const isHasDoubleRowText=typeof is_has_double_row_text=="boolean"?is_has_double_row_text:false;const isBothReport=typeof reportType=="string"&&reportType=="both";(function(System,$){$(function(){if(isDetailReport){var FoldState=System.operateState.getFoldState(Report.report_id);if(isWord){var DetailNum=System.operateState.getDetailNum(Report.report_id);var Detailoffset=System.operateState.getDetailoffset(Report.report_id);var DetailSize=System.operateState.getDetailSize(Report.report_id);var ZoomBtnState=System.operateState.getZoomBtnState(Report.report_id);var LineState=System.operateState.getLineState(Report.report_id)}else{var DetailNum=System.operateState.getPlainTextDetailNum(Report.report_id);var Detailoffset=System.operateState.getPlainTextDetailoffset(Report.report_id);var DetailSize=System.operateState.getPlainTextDetailSize(Report.report_id);var ZoomBtnState=System.operateState.getPlainTextZoomBtnState(Report.report_id);var LineState=System.operateState.getPlainTextLineState(Report.report_id)}}if(isAIReport){var FoldState=System.operateState.getFoldStateAI(Report.report_id);if(isWord){var DetailNum=System.operateState.getDetailNumAI(Report.report_id);var Detailoffset=System.operateState.getDetailoffsetAI(Report.report_id);var DetailSize=System.operateState.getDetailSizeAI(Report.report_id);var ZoomBtnState=System.operateState.getZoomBtnStateAI(Report.report_id);var LineState=System.operateState.getLineStateAI(Report.report_id)}else{var DetailNum=System.operateState.getPlainTextDetailNumAI(Report.report_id);var Detailoffset=System.operateState.getPlainTextDetailoffsetAI(Report.report_id);var DetailSize=System.operateState.getPlainTextDetailSizeAI(Report.report_id);var ZoomBtnState=System.operateState.getPlainTextZoomBtnStateAI(Report.report_id);var LineState=System.operateState.getPlainTextLineStateAI(Report.report_id)}}if(isProofReport){var FoldState=System.operateState.getFoldState2(Report.report_id);if(isWord){var DetailNum=System.operateState.getProofNum(Report.report_id);var Detailoffset=System.operateState.getProofOffset(Report.report_id);var DetailSize=System.operateState.getProofSize(Report.report_id);var ZoomBtnState=System.operateState.getProZoomBtnState(Report.report_id)}else{var DetailNum=System.operateState.getPlainTextProofNum(Report.report_id);var Detailoffset=System.operateState.getPlainTextProofOffset(Report.report_id);var DetailSize=System.operateState.getPlainTextProofSize(Report.report_id);var ZoomBtnState=System.operateState.getPlainTextProZoomBtnState(Report.report_id)}}if(isBothReport){var isHasLinkage=System.operateState.getLinkageState(Report.report_id);isHasLinkage=isHasLinkage===""?true:isHasLinkage}const totalPage=$(".upkmzjakmc").length;let pageNumHtml=`<span class="pageNum"></span><span class="partition">/</span><span class="totalPage">${totalPage}</span>`;$(".top_Num").html(pageNumHtml).show();DetailNum=DetailNum?DetailNum:1;DetailSize=DetailSize?DetailSize:1;size=DetailSize;parentWidth(DetailSize);AddH(DetailSize);if(isDetailReport||isAIReport){FuncLine(LineState);SimilarityFun("init",size)}if(Detailoffset){$("body").scrollTop(Detailoffset)}else{$(".pageNum").text(DetailNum);$(".input_pageNum").val(DetailNum);$("#toall_Num").attr("href","#"+DetailNum);$(".top_a").attr("href","#"+(DetailNum-1));$(".bottom_a").attr("href","#"+(DetailNum+1))}if(ZoomBtnState==""||ZoomBtnState=="block"){$(".allButton").hide();$(".CollagenButton").hide();$("#menuButton").css("background","#323639")}else{$(".allButton").show();$(".CollagenButton").show();$("#menuButton").css("background","#1b1e1f")}if(isBothReport){$("body").append(`<div class="report-type-label">${isAIReport?"AIGC检测":"查重"}报告</div>`).addClass("b-body")}var nowPage=1;function scrollFunc(offsetH){var scrollH=-15;$(".upkmzjakmc").each(function(k,v){var PageH=$(v)[0].getBoundingClientRect().height+15;if(scrollH<offsetH&&offsetH<=scrollH+PageH){nowPage=k+1}scrollH+=PageH});$(".input_pageNum").val(nowPage);$(".pageNum").text(nowPage);$("#toall_Num").attr("href","#"+nowPage);$(".top_a").attr("href","#"+(nowPage-1));$(".bottom_a").attr("href","#"+(nowPage+1))}var checkSendable=true;var aiSendable=true;var calcTimeout=null;var scrollTimeout=null;function parentWidth(size){let _Size=Math.round(size*100)/100;percent=Math.round(_Size*100);$(".percent_num").text(percent?percent:100);$(".upkmzjakmc").css("transform","scale("+_Size+")");if(_Size<1){$(".upkmzjakmc").css("transform-origin","left top")}else{$(".upkmzjakmc").css("transform-origin","center top")}$(".upkmzjakmc").each(function(k,v){var pageW=this.getBoundingClientRect().width+30;var pageH=this.getBoundingClientRect().height+15;$(this).parent(".jcjymywwzd").css("width",pageW);$(this).parent(".jcjymywwzd").css("height",pageH)});if(nowPage!=undefined){$(".jump_page").attr("href","#"+nowPage);$("#jumpBtn").attr("href","#"+nowPage);$(".jumpBtn").trigger("click")}if(isDetailReport){if(isBothReport&&isHasLinkage){checkSendable?parent.postMessage({checkSize:_Size},"*"):checkSendable=true}if(calcTimeout)clearTimeout(calcTimeout);calcTimeout=setTimeout(()=>{if(isWord){System.operateState.saveDetailSize(Report.report_id,_Size)}else{System.operateState.savePlainTextDetailSize(Report.report_id,_Size)}calcTimeout=null;checkSendable=true;aiSendable=true},500)}if(isAIReport){if(isBothReport&&isHasLinkage){aiSendable?parent.postMessage({aiSize:_Size},"*"):aiSendable=true}if(calcTimeout)clearTimeout(calcTimeout);calcTimeout=setTimeout(()=>{if(isWord){System.operateState.saveDetailSizeAI(Report.report_id,_Size)}else{System.operateState.savePlainTextDetailSizeAI(Report.report_id,_Size)}calcTimeout=null;checkSendable=true;aiSendable=true},500)}if(isProofReport){if(isWord){System.operateState.saveProofSize(Report.report_id,_Size)}else{System.operateState.savePlainTextProofSize(Report.report_id,_Size)}}}function throttle(fn,delay){let timer=null;let starttime=Date.now();return function(){let curTime=Date.now();let remaining=delay-(curTime-starttime);let context=this;let args=arguments;clearTimeout(timer);if(remaining<=0){fn.apply(context,args);starttime=Date.now()}else{timer=setTimeout(fn,remaining)}}}const throttledHandleScroll=throttle(handleScroll,20);document.body.addEventListener("scroll",function(e){let scrollAxis={x:e.target.scrollLeft,y:e.target.scrollTop};if(isBothReport&&isHasLinkage){if(isDetailReport&&checkSendable){parent.postMessage({checkAxis:scrollAxis},"*")}else{checkSendable=true}if(isAIReport&&aiSendable){parent.postMessage({aiAxis:scrollAxis},"*")}else{aiSendable=true}}throttledHandleScroll()});function handleScroll(){Detailoffset=document.body.scrollTop;scrollFunc(Detailoffset);var top=Detailoffset*$(".slide-track-item").height()/($("#mbxsgxktna").height()+15);$(".slide-thumb").css("top",top+"px");var Page=nowPage;var obj=isHasLinkage?{PageNum:Page,page_nav_click:page_nav_click}:{PageNum:Page,page_nav_click:page_nav_click,pageNav:pageNav};parent.parent.postMessage(obj,"*");if(scrollTimeout)clearTimeout(scrollTimeout);scrollTimeout=setTimeout(()=>{if(isDetailReport){if(isWord){System.operateState.saveDetailNum(Report.report_id,Page);System.operateState.saveDetailoffset(Report.report_id,Detailoffset)}else{System.operateState.savePlainTextDetailNum(Report.report_id,Page);System.operateState.savePlainTextDetailoffset(Report.report_id,Detailoffset)}}if(isAIReport){if(isWord){System.operateState.saveDetailNumAI(Report.report_id,Page);System.operateState.saveDetailoffsetAI(Report.report_id,Detailoffset)}else{System.operateState.savePlainTextDetailNumAI(Report.report_id,Page);System.operateState.savePlainTextDetailoffsetAI(Report.report_id,Detailoffset)}}if(isProofReport){if(isWord){System.operateState.saveProofNum(Report.report_id,Page);System.operateState.saveProofOffset(Report.report_id,Detailoffset)}else{System.operateState.savePlainTextProofNum(Report.report_id,Page);System.operateState.savePlainTextProofOffset(Report.report_id,Detailoffset)}}scrollTimeout=null;checkSendable=true;aiSendable=true},500)}if(isBothReport&&(!isHasDoubleRowWord||!isHasDoubleRowText)){$(".Switch").remove()}$(".Switch").click(function(){$(".layui-layer-shade").css("display","block");$(".layui-layer-title").html("切换模式");$(".detail_btn").data("type","switch");if(isWord){$(".layui-layer-content").html("确认切换至“纯文字模式”吗？")}else{$(".layui-layer-content").html("确认切换至“标准模式”吗？")}});$(".detail_btn").click(function(){type=$(this).data("type");if(type=="switch"){$(".layui-layer-btn0").attr("href",$(this).data("txtLink"));parent.parent.postMessage("switch","*");if(isBothReport||isDetailReport){if(isWord){parent.postMessage("word_right","*");System.operateState.saveInitPage(Report.report_id,"switch_text")}else{parent.postMessage("text_right","*");System.operateState.saveInitPage(Report.report_id,"switch_word")}}if(isBothReport||isAIReport){if(isWord){parent.postMessage("word_right","*");System.operateState.saveInitPageAI(Report.report_id,"switch_text")}else{parent.postMessage("text_right","*");System.operateState.saveInitPageAI(Report.report_id,"switch_word")}}if(isProofReport){if(isWord){parent.postMessage("proof_right","*");System.operateState.saveProofInitPage(Report.report_id,"proof_switch_text")}else{parent.postMessage("proofPt_right","*");System.operateState.saveProofInitPage(Report.report_id,"proof_switch_word")}}}});$(".layui-layer-btn1, .layui-layer-btn0, .layui-layer-setwin").click(function(){$(".layui-layer-shade").css("display","none")});var bodyDOM=document.querySelector("#mbxsgxktna").cloneNode(true).innerHTML;var sheetCSS=document.querySelector("style").cloneNode(true).innerHTML;var cloneHTML={sheetCSS:sheetCSS,bodyDOM:bodyDOM,isAIReport:isAIReport};parent.parent.postMessage(cloneHTML,"*");let red_a_eq=$(".red").parent("a").eq(0);let orange_a_eq=$(".orange").parent("a").eq(0);let purple_a_eq=$(".purple").parent("a").eq(0);$(".subline").click(function(){$(".layui-layer-shade").css("display","block");$(".layui-layer-title").html("辅助线");curHref=$(".detail_btn").attr("href");if(curHref!="#"){$(".detail_btn").data("txtLink",$(".detail_btn").attr("href"));$(".layui-layer-btn0").attr("href","#")}$(".detail_btn").data("type","subline");let flag=red_a_eq.hasClass("red_a")||orange_a_eq.hasClass("orange_a")||purple_a_eq.hasClass("purple_a");let html=`<div>确认“${flag?"取消":"使用"}辅助线”吗？</div><div class="subline-line">${isAIReport?"实线：疑似度在70%以上<br>虚线：疑似度在60%~70%<br>双实线：疑似度在50%~60%":"实线：相似度60%以上<br>虚线：相似度40%-60%"}</div>`;$(".layui-layer-content").html(html)});function FuncLine(Line){let red_a=$(".red").parent("a");let orange_a=$(".orange").parent("a");let purple_a=$(".purple").parent("a");if(Line=="true"||Line==""){red_a.removeClass("red_a");orange_a.removeClass("orange_a");purple_a.removeClass("purple_a");$(".subline").removeClass("active")}else{red_a.addClass("red_a");orange_a.addClass("orange_a");purple_a.addClass("purple_a");$(".subline").addClass("active")}if(isDetailReport){if(isWord){System.operateState.saveLineState(Report.report_id,Line)}else{System.operateState.savePlainTextLineState(Report.report_id,Line)}}if(isAIReport){if(isWord){System.operateState.saveLineStateAI(Report.report_id,Line)}else{System.operateState.savePlainTextLineStateAI(Report.report_id,Line)}}}$("body").on("click",".layui-layer-btn0",function(){if($(".layui-layer-title").html()!=="辅助线"){return}var has_red=$("span").hasClass("red");var has_orange=$("span").hasClass("orange");var has_purple=$("span").hasClass("purple");if(isDetailReport&&has_red==false&&has_orange==false||isAIReport&&has_red==false&&has_orange==false&&has_purple==false){FuncLine("")}else{var has_Class=red_a_eq.hasClass("red_a")||orange_a_eq.hasClass("orange_a")||purple_a_eq.hasClass("purple_a");LineState=String(has_Class);FuncLine(LineState);isBothReport&&isHasLinkage&&parent.postMessage({LineState:LineState},"*")}});$(".input_pageNum").focus(function(){$(".input_pageNum").select()}).blur(function(){page1=$(".input_pageNum").val();if(page1<=totalPage&&/^[1-9]\d*$/.test(page1)){$("#toall_Num").attr("href","#"+page1)}else{$(".input_pageNum").val(nowPage)}}).keyup(function(){if(event.keyCode==13){page1=$(".input_pageNum").val();if(page1<=totalPage&&/^[1-9]\d*$/.test(page1)){$("#toall_Num").attr("href","#"+page1);window.location.hash="#"+page1}else{$(".input_pageNum").val(nowPage);$(".input_pageNum").blur()}}});var isHas=hasScrollbar();if(isHas){var width=getScrollbarWidth();$(".btn_fold").css("right",width+"px");$(".Shadow").css("width","calc(100% - "+width+"px)")}else{$(".btn_fold").css("right",0+"px");$(".Shadow").css("width","100%")}$(".btn_fold").click(function(){FoldState=$(".btn_fold_left").css("display");foldFun(FoldState);if(isDetailReport){System.operateState.saveFoldState(Report.report_id,FoldState)}else if(isAIReport){System.operateState.saveFoldStateAI(Report.report_id,FoldState)}else{System.operateState.saveFoldState2(Report.report_id,FoldState)}});foldFun(FoldState);function foldFun(FoldState){if(FoldState=="none"){$(".btn_fold_left").css("display","block");$(".btn_fold_right").css("display","none")}else{$(".btn_fold_left").css("display","none");$(".btn_fold_right").css("display","block")}var obj={FoldState:FoldState};parent.postMessage(obj,"*");parent.parent.postMessage(obj,"*")}var percent;$("#originalButton").on("click",function(e){e.preventDefault();zoomShow();size=1;_size=size;parentWidth(_size);AddH(_size);SimilarityFun("scroll",_size);HideShade()});$("#fitPageButton").click(function(e){e.preventDefault();zoomShow();var fitPage_h=$("body")[0].getBoundingClientRect().height;size=(fitPage_h-20)/minHeight;_size=size;parentWidth(_size);AddH(_size);SimilarityFun("scroll",_size);HideShade()});$("#fitWidthButton").click(function(e){e.preventDefault();zoomShow();var fitWidth_w=$("body")[0].getBoundingClientRect().width;size=(fitWidth_w-163)/minWidth;if(size>2){size=2}_size=size;parentWidth(_size);AddH(_size);SimilarityFun("scroll",_size);HideShade()});function roundFun(value,n){return Math.round(value*Math.pow(10,n))/Math.pow(10,n)}$("#zoomOutButton").click(function(e){e.preventDefault();if(percent%10==0&&size<=2){size+=.1}if(percent%10>=5&&size<=2){size=roundFun(percent/100,1)}if(percent%10<5&&size<=2){size=roundFun(percent/100,1)+.1}if(size>2){size=2;$(".percent_num").text(size*100);return}zoomShow();_size=size;parentWidth(_size);AddH(_size);SimilarityFun("scroll",_size);HideShade()});$("#zoomInButton").click(function(e){e.preventDefault();if(percent%10==0&&size>=.1){size-=.1}else if(percent%10>=5&&size>=.1){size=roundFun(percent/100,1)-.1}else if(percent%10<5&&size>=.1){size=roundFun(percent/100,1)}if(size<.1){size=.1;$(".percent_num").text(size*100);return}zoomShow();_size=size;parentWidth(_size);AddH(_size);SimilarityFun("scroll",_size);HideShade()});$("#CollagenButton").click(function(e){e.stopPropagation();var listState=$(".percent_list").css("display");if(listState=="block"){$(".percent_list").hide();$(this).children(".percent_tip").css("display","block")}else{$(".percent_list").show();$("#CollagenButton").css("background","#1b1e1f")}$(this).children(".percent_tip").css("display","none")}).mousemove(function(){$("#CollagenButton").css("background","#1b1e1f");if($(".percent_list").css("display")=="block"){$(this).children(".percent_tip").css("display","none")}else{$(this).children(".percent_tip").css("display","block")}}).mouseout(function(){if($(".percent_list").css("display")=="block"){$("#CollagenButton").css("background","#1b1e1f")}else{$("#CollagenButton").css("background","#323639")}$(this).children(".percent_tip").css("display","none")});$(document).click(function(){$(".percent_list").hide();$("#CollagenButton").css("background","#323639")});$(".zoom-shade").click(function(e){var listState=$(".percent_list").css("display");if(listState=="block"){$(".percent_list").show()}else{$(".percent_list").hide()}e.stopPropagation()});$(".percent_li").click(function(e){e.preventDefault();zoomShow();var liTxt=$(this).children(".li_text").text();size=liTxt/100;_size=size;parentWidth(_size);AddH(_size);SimilarityFun("scroll",_size);HideShade();e.stopPropagation()}).mousemove(function(){$(this).css("background","#1b1e1f")}).mouseout(function(){$(this).css("background","#323639")});$("#menuButton").click(function(){var showState=$(".allButton").css("display");$(".percent_list").hide();$("#CollagenButton").css("background","#323639");if(isDetailReport){if(isWord){System.operateState.saveZoomBtnState(Report.report_id,showState)}else{System.operateState.savePlainTextZoomBtnState(Report.report_id,showState)}}else if(isAIReport){if(isWord){System.operateState.saveZoomBtnStateAI(Report.report_id,showState)}else{System.operateState.savePlainTextZoomBtnStateAI(Report.report_id,showState)}}else{if(isWord){System.operateState.saveProZoomBtnState(Report.report_id,showState)}else{System.operateState.savePlainTextProZoomBtnState(Report.report_id,showState)}}if(showState=="block"){$(".allButton").hide();$(".CollagenButton").hide();$("#menuButton").css("background","#323639")}else{$(".allButton").show();$(".CollagenButton").show();$("#menuButton").css("background","#1b1e1f")}}).mousemove(function(){$("#menuButton").css("background","#1b1e1f");$(this).children(".menu_tip").css("display","block")}).mouseout(function(){$(this).children(".menu_tip").css("display","none");if($(".allButton").css("display")=="block"){$("#menuButton").css("background","#1b1e1f")}else{$("#menuButton").css("background","#323639")}});function zoomShow(){$(".zoom-shade").css("opacity",totalPage<100?0:.3);$(".zoom-shade").show()}function HideShade(){$(".zoom-shade").hide()}if(isDetailReport||isAIReport){$("#mbxsgxktna a[target='right']").mouseover(function(){$("#mbxsgxktna").append(`<div class="similarTip"></div>`)}).mousemove(function(e){let cw=document.documentElement.clientWidth;let ch=document.documentElement.clientHeight;let x=e.pageX+document.body.scrollLeft;let y=e.pageY+document.body.scrollTop;let text=(isAIReport?"疑似度：":"相似度：")+`${this.dataset.score}%`;let html=FoldState=="none"?`${text}</br>${isAIReport?"查看片段详细识别结果，请展开右侧！":"查看句子详细结果，请展开右侧！"}`:text;$("div[class='similarTip']").html(html).css({left:x+20,top:y+20});if(ch-e.pageY<70){$("div[class='similarTip']").css({top:y-50})}if(cw-e.pageX<120){$("div[class='similarTip']").css({left:x-100})}}).mouseout(function(){$("div[class='similarTip']").remove()}).click(function(){if(FoldState=="none")return})}var page_nav_click="false";var pageNav=isAIReport?"ai_page_navigation":"page_navigation";window.addEventListener("message",function(event){if(event.data.EnterId){if(isHasLinkage){window.location.hash="#"+event.data.EnterId}else{if(event.data.pageNav=="ai_page_navigation"&&isAIReport){window.location.hash="#"+event.data.EnterId}if(event.data.pageNav=="page_navigation"&&isDetailReport){window.location.hash="#"+event.data.EnterId}pageNav=event.data.pageNav}}if(event.data.page_nav_click){page_nav_click=event.data.page_nav_click}if(typeof event.data.isHasLinkage=="boolean"){isHasLinkage=event.data.isHasLinkage;System.operateState.saveLinkageState(Report.report_id,isHasLinkage);if(isHasLinkage){if(isWord){Detailoffset=System.operateState.getDetailoffset(Report.report_id);DetailSize=System.operateState.getDetailSize(Report.report_id);LineState=System.operateState.getLineState(Report.report_id)}else{Detailoffset=System.operateState.getPlainTextDetailoffset(Report.report_id);DetailSize=System.operateState.getPlainTextDetailSize(Report.report_id);LineState=System.operateState.getPlainTextLineState(Report.report_id)}checkSendable=false;aiSendable=false;zoomShow();_size=DetailSize?DetailSize:size;parentWidth(_size);AddH(_size);SimilarityFun("scroll",_size);HideShade();FuncLine(LineState);$("body").scrollTop(Detailoffset)}}if(event.data.checkAxis){let x=$("body").scrollLeft();let y=$("body").scrollTop();if(event.data.checkAxis.y!=y||event.data.checkAxis.x!=x){aiSendable=false;$("body").scrollTop(event.data.checkAxis.y).scrollLeft(event.data.checkAxis.x)}}if(event.data.aiAxis){let x=$("body").scrollLeft();let y=$("body").scrollTop();if(event.data.aiAxis.y!=y||event.data.aiAxis.x!=x){checkSendable=false;$("body").scrollTop(event.data.aiAxis.y).scrollLeft(event.data.aiAxis.x)}}if(isDetailReport&&event.data.aiSize){checkSendable=false;zoomShow();size=event.data.aiSize;_size=size;parentWidth(_size);AddH(_size);SimilarityFun("scroll",_size);HideShade()}if(isAIReport&&event.data.checkSize){aiSendable=false;zoomShow();size=event.data.checkSize;_size=size;parentWidth(_size);AddH(_size);SimilarityFun("scroll",_size);HideShade()}if(event.data.LineState){LineState=event.data.LineState;FuncLine(LineState)}})})})(Report,jQuery);function hasScrollbar(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)}function getScrollbarWidth(){var scrollDiv=document.createElement("div");scrollDiv.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;";document.body.appendChild(scrollDiv);var scrollbarWidth=scrollDiv.offsetWidth-scrollDiv.clientWidth;document.body.removeChild(scrollDiv);return scrollbarWidth}var arrW=new Array;var arrH=new Array;$(".upkmzjakmc").each(function(k,v){arrW.push($(this).width())});$(".upkmzjakmc").each(function(k,v){arrH.push($(this).height())});function getMaxCountWidth(arr){var mp=new Array;for(var idx in arr){var item=arr[idx];var count=0;if(!mp.hasOwnProperty(item)){mp[item]=1}else{count=mp[item];count=count+1;mp[item]=count}}var maxCount=0;var width=0;for(var key in mp){var val=mp[key];if(val>=maxCount){maxCount=val;if(width==0){width=key}else if(key>width){width=key}}}return width}function getMaxCountHeight(arr){var mp=new Array;for(var idx in arr){var item=arr[idx];var count=0;if(!mp.hasOwnProperty(item)){mp[item]=1}else{count=mp[item];count=count+1;mp[item]=count}}var maxCount=0;var height=0;for(var key in mp){var val=mp[key];if(val>=maxCount){maxCount=val;if(height==0){height=key}else if(key<height){height=key}}}return height}var minWidth=getMaxCountWidth(arrW);var minHeight=getMaxCountHeight(arrH);var size=1;var _size;function AddH(size){var h=document.documentElement.clientHeight;var last_h=$(".upkmzjakmc:last")[0].getBoundingClientRect().height+30;var AddH=h-last_h;if(last_h>=h){$("#Add_height").css("height",0)}else{$("#Add_height").css("height",AddH)}var w=document.documentElement.clientWidth;var mWidth=minWidth*size;var topNumWidth=$(".top_Num").width()+25;var right=(w-mWidth)/2;if(mWidth<=500){right=right-topNumWidth}else if(mWidth>=w-105){right=77}else{right=right+15}$(".top_Num").css("right",right)}function hideThumb(){if($("#mbxsgxktna").height()<$("body").height()){$(".slide-thumb").hide()}else{$(".slide-thumb").show()}}var mergeArry;function SimilarityFun(scrllType,scaleNum=1){hideThumb();var multArry=[];var contBoxHeight=$("#mbxsgxktna").height()+15;for(var i=0;i<contBoxHeight;i++){multArry.push({color:"white",height:1,top:i,zIndex:0})}var nodeArry=[];var $jcjymywwzd=document.querySelectorAll(".jcjymywwzd");$.each($jcjymywwzd,function(index,item){var odiv=item.getElementsByTagName("span");for(var i=0;i<odiv.length;i++){nodeArry.push(odiv[i])}});var multipleNum=1;var initH=0;if(isDetailReport||isAIReport){if(isWord){multipleNum=10}}if(scrllType=="scroll"){initH=$("body").scrollTop()}var orangeArry=[];var redArry=[];var purpleArry=[];$.each(nodeArry,function(index,item){var o={};if(item.classList.contains("orange")){o.color="orange";o.zIndex=1;o.height=Math.round($(item).height()*scaleNum/multipleNum);o.top=Math.round($(item).offset().top+initH);orangeArry.push(o)}else if(item.classList.contains("red")){o.color="red";o.zIndex=2;o.height=Math.round($(item).height()*scaleNum/multipleNum);o.top=Math.round($(item).offset().top+initH);redArry.push(o)}else if(item.classList.contains("purple")){o.color="purple";o.zIndex=0;o.height=Math.round($(item).height()*scaleNum/multipleNum);o.top=Math.round($(item).offset().top+initH);purpleArry.push(o)}});if(purpleArry.length>0){for(var j=0;j<purpleArry.length;j++){for(var k=0;k<purpleArry[j].height;k++){var topIndex=purpleArry[j].top;multArry.splice(topIndex+k,1,{color:"purple",height:1,top:topIndex+k,zIndex:0})}}}if(orangeArry.length>0){for(var j=0;j<orangeArry.length;j++){for(var k=0;k<orangeArry[j].height;k++){var topIndex=orangeArry[j].top;multArry.splice(topIndex+k,1,{color:"orange",height:1,top:topIndex+k,zIndex:1})}}}if(redArry.length>0){for(var j=0;j<redArry.length;j++){for(var k=0;k<redArry[j].height;k++){var topIndex=redArry[j].top;multArry.splice(topIndex+k,1,{color:"red",height:1,top:topIndex+k,zIndex:2})}}}mergeArry=JSON.parse(JSON.stringify(multArry));for(var i=mergeArry.length-1;i>0;i--){if(!!mergeArry[i-1]){if(mergeArry[i-1].color==mergeArry[i].color){mergeArry[i-1].height=mergeArry[i].height+1;mergeArry.splice(i,1)}}}for(var i=mergeArry.length-1;i>0;i--){if(!!mergeArry[i-2]){if(mergeArry[i].color!="white"&&mergeArry[i-1].color=="white"){if(mergeArry[i].height>mergeArry[i-1].height&&mergeArry[i-2].height>mergeArry[i-1].height){var halfHeight=mergeArry[i-1].height;var upHeight=Math.round(halfHeight*mergeArry[i-2].height/(mergeArry[i-2].height+mergeArry[i].height));var downHeight=mergeArry[i-1].height-upHeight;mergeArry[i-2].height=mergeArry[i-2].height+upHeight;mergeArry[i].height=mergeArry[i].height+downHeight;mergeArry[i].top=mergeArry[i].top-downHeight;mergeArry.splice(i-1,1)}}}}var sum=0;mergeArry.forEach((item,index)=>{if(index<mergeArry.length-1){item.rate=item.height/contBoxHeight*100;sum+=Number(item.rate)}else{item.rate=Number(100-sum)}});slideScrollBar()}function GetPercent(num,total){num=parseFloat(num);total=parseFloat(total);if(isNaN(num)||isNaN(total)){return"-"}return total<=0?"0%":Number((num/total*1e4/100).toFixed(2))}function slideScrollBar(){var restH=$(".slide-track-item").height();var mbHeight=$("#mbxsgxktna").height()+15;if(isDetailReport||isAIReport){var offsetH=$("body").scrollTop();var top=offsetH*$(".slide-track-item").height()/($("#mbxsgxktna").height()+15);$(".slide-thumb").css("top",top+"px");$(".slide-track-item").html("");var str="";if(mergeArry){mergeArry.forEach((element,i)=>{str+=`<div style="position: absolute;height: ${restH*(element.rate/100)}px;top:${element.top/mbHeight*100}%;z-index:${element.zIndex};" class="slide_color ${element.color}"></div>`})}$(".slide-track-item").append(str)}$(".slide-track-item,.slide-cover").click(function(e){top=e.clientY-$(".slide-scrollbar")[0].offsetTop-$(".slide-thumb").height()/2;if(top<0){top=0}let scrollTop=parseInt(top*($("#mbxsgxktna").height()+15)/restH);$("body").scrollTop(scrollTop);return false});if($(".slide-scrollbar")[0]){$(".slide-scrollbar")[0].addEventListener("wheel",function(event){var restH=$(".slide-track-item").height();var top=parseInt($(".slide-thumb").css("top"));var e=event||window.event;var delta=e.wheelDelta||-e.deltaY*40;if(e.deltaY>0){top+=Math.abs(delta/120);if(top>restH){top=restH}}else if(e.deltaY<0){top-=Math.abs(delta/120);if(top<0){top=0}}let scrollTop=parseInt(top*($("#mbxsgxktna").height()+15)/restH);$("body").scrollTop(scrollTop);return false},false)}$(".slide-thumb").mousedown(function(event){let offsetTop=$(".slide-thumb")[0].offsetTop;let e=event||window.event;let mouseY=e.clientY;$(document).mousemove(function(event){let e=event||window.event;let moveTop=e.clientY-mouseY;let top=offsetTop+moveTop;if(top<0){top=0}let scrollTop=parseInt(top*($("#mbxsgxktna").height()+15)/restH);$("body").scrollTop(scrollTop);return false});$(document).mouseup(function(e){$(document).off("mousemove");return false});return})}$(window).resize(function(){AddH(size);if(isDetailReport||isAIReport){slideScrollBar()}var isHas=hasScrollbar();if(isHas){var width=getScrollbarWidth();$(".btn_fold").css("right",width+"px")}else{$(".btn_fold").css("right",0+"px")}});$(document).on("click",function(){parent.parent.postMessage("documentClickEvent","*")});window.onload=function(){isAIReport?parent.parent.postMessage("AIPAGELOADED","*"):parent.parent.postMessage("PAGELOADED","*")};