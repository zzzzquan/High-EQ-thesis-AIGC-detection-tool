const checkType=typeof check_type=="string"&&check_type;const hasReduceAI=typeof reduce_ai=="boolean"?reduce_ai:false;const isReduceAIReport=rewriteAI=="reduce_ai";const isOnlineView=typeof is_online_view=="boolean"&&is_online_view;const hasReduceAIWord=typeof has_reduce_ai_word=="boolean"&&isOnlineView?hasReduceAI?has_reduce_ai_word:true:false;const hasReduceAIMarkWord=typeof has_reduce_ai_mark_word=="boolean"&&isOnlineView?hasReduceAI?has_reduce_ai_mark_word:true:false;let version={free:"免费版",ultimate:"旗舰版",published:"职称版",safeguard:"维权版"};version=version[checkType];if(hasReduceAI){$(".reduce-aigc-qa").remove();let e=reduceAiDataInfo.reduceTotalSuspectedTextRatio>reduceAiDataInfo.totalSuspectedTextRatio*.5||reduceAiDataInfo.totalSuspectedTextRatio==0;if(!e){$(".reduce-aigc-tip").remove()}}else{$(".reduce-aigc-qa .btn-experience").attr("href",reduceAiPayUrl);$(".reduce-aigc-tip").remove()}(function(t,i){if(rewriteAI=="reduce_ai"){ReportID=ReportID+`_reduce_ai`}else{ReportID=ReportID+`_ai`}t.operateState.saveId(ReportID);let e=t.operateState.getReduceTab(ReportID);let r=t.operateState.getReduceOffset(ReportID);let c=t.operateState.getReduceDiffShow(ReportID);let a=t.operateState.getReduceCurrentPage(ReportID);let o=template("basic-info",{pid:ReportID.split("_")[0],score:reduceAiDataInfo.score,version:version,hasReduceAI:hasReduceAI,isReduceAIReport:isReduceAIReport,reduceAiPayUrl:reduceAiPayUrl,reduceAiScore:reduceAiDataInfo.reduceAiScore,totalSuspectedTextRatio:reduceAiDataInfo.totalSuspectedTextRatio,reduceTotalSuspectedTextRatio:reduceAiDataInfo.reduceTotalSuspectedTextRatio,hasReduceAIWord:hasReduceAIWord,hasReduceAIMarkWord:hasReduceAIMarkWord});i(".reduce-similarity-wrapper").html(o);if(hasReduceAI){updateFileNameAndPath()}else{let a=140;i(".reduce-similarity-wrapper .before .text").each((e,t)=>{a+=t.getBoundingClientRect().width});a=a-(i(".reduce-similarity-wrapper .btn-get-similarity")[0].getBoundingClientRect().width+12);i(".reduce-similarity-wrapper .btn-get-similarity").css("margin-right",a)}i(".reduce-tab-content").html(template("reduce-content",{ReduceTab:e,ReduceDiffShow:c}));let n=mergeSectionCount(reduceAiDataInfo.fullDataList);let s=template("full-content",{hasReduceAI:hasReduceAI,content:n,reduceAiScore:reduceAiDataInfo.reduceAiScore,totalSuspectedTextRatio:reduceAiDataInfo.totalSuspectedTextRatio,reduceTotalSuspectedTextRatio:reduceAiDataInfo.reduceTotalSuspectedTextRatio,pid:ReportID.split("_")[0],hasReduceAIWord:isOnlineView&&hasReduceAIWord});i(".view-whole-content").html(s);let d=[];let u=a-0||1;if(reduceAiDataInfo.totalPageNum>1){for(let e=0;e<reduceAiDataInfo.totalPageNum;e++){d.push(e+1)}let e=template("pagination",{totalPages:d,page:u,pageSize:500});i(".pagination").html(e)}let l=[];p(u);async function p(a){if(!l[a-1]){let e=await getReduceAiListInfo(a-1);e.forEach(e=>{let t=after="";e.originalFragmentInfo.sectionContentList.forEach(e=>{e=filterCharacter(e);t=`${t}<p>${e}</p>\r\n`});if(typeof e.reduceAiResultList!="undefined"&&e.reduceAiResultList.length>0){e.reduceAiResultList[0].sectionContentList.forEach(e=>{e=filterCharacter(e);after=`${after}<p>${e}</p>\r\n`});e.reduceAiResultList.content=after;e.differResult=differResultHtml(e.reduceAiResultList[0].differResultDataList)}e.originalFragmentInfo.content=t});l[a-1]=e;let t=document.querySelector("#reduceaigcpagelistdata");document.body.removeChild(t)}setTimeout(()=>{let e=template("reduce-repeat-list",{data:l[a-1],hasReduceAI:hasReduceAI,reduceAiPayUrl:reduceAiPayUrl,ReduceDiffShow:c});i(".reduce-repeat-table").html(e);if(r!=""){i("body").scrollTop(r)}},50)}i(document).on("click",".pagination span",async function(){if(i(this).hasClass("prev")){u=u-1}else if(i(this).hasClass("next")){u=u+1}else{u=this.textContent-0}paginationHtml=template("pagination",{totalPages:d,page:u});i(".pagination").html(paginationHtml);i(".reduce-repeat-table").html(`<div class="loading">正在加载列表，请稍等...</div>`);p(u);t.operateState.saveReduceCurrentPage(ReportID,u)});var f=(e,t)=>{let a=i(e).data("zhuge");if(typeof a=="undefined"){i(e).data("zhuge","isClicked");if(typeof zhuge!="undefined"){zhuge.track("在线报告点击",{"检测版本":check_type,"降重版本":consume_type,"按钮":t})}}};i("body").off("scroll").on("scroll",function(){let e=i("body").scrollTop();t.operateState.saveReduceOffset(ReportID,e)});i(document).on("click",".reduce-repeat-container .tab-pills li",function(){let e=i(this).index();i(this).addClass("active").siblings().removeClass("active");i(".reduce-repeat-container section > .tab-content").hide();i(".reduce-repeat-container section > .tab-content:eq("+e+")").show();if(e==0){i(".checked-list").show()}else{i(".checked-list").hide()}t.operateState.saveReduceTab(ReportID,this.textContent);f(this,`选项卡-${this.textContent}`)});i(document).on("change",".checked-list .item #diff",function(){if(this.checked){i(".reduce-repeat-column .item-comparison").css("display","grid");i(".checked-desc-tip .diff").show()}else{i(".reduce-repeat-column .item-comparison").css("display","none");i(".checked-desc-tip .diff").hide()}t.operateState.saveReduceDiffShow(ReportID,this.checked);f(this,`显示降AIGC前后对比-${this.checked}`)});i(document).on("click",".reduce-report",function(e){e.preventDefault();if(hasReduceAI){window.open(this.href,this.href)}else{if(this.dataset.type=="降AIGC前报告"){parent.postMessage("reload","*")}else{parent.postMessage({url:reduceAiPayUrl,reduceMsg:"此报告没有购买降AIGC服务，无法查看降AIGC后的检测报告！</br>请购买智能降AIGC服务。"},"*")}}f(this,`报告类型-${this.dataset.type}`)});i(document).on("click",".reduce-word, .message .reduce-word a[data-type=降AIGC后word]",function(e){e.preventDefault();if(hasReduceAI){window.open(this.href)}else{parent.postMessage({url:reduceAiPayUrl,reduceMsg:"此报告没有购买降AIGC服务，无法查看降AIGC后的Word！<br>请购买智能降AIGC服务。"},"*")}f(this,`智能降AIGC下载-${this.dataset.type}`)});i(document).on("click",".btn-get-similarity",function(){parent.postMessage({url:reduceAiPayUrl,reduceMsg:"此报告没有购买降AIGC服务，无法查看降AIGC后的疑似度！<br>请购买智能降AIGC服务。"},"*")});i(document).on("click",".btn-copy",function(){const e=i(this).parents().hasClass("view-whole-content")?hasReduceAI?i(this).parents(".view-whole-content"):"postMessage":i(this).parents(".reduce-repeat-column");if(e=="postMessage")return parent.postMessage({url:reduceAiPayUrl,reduceMsg:"此报告没有购买降AIGC服务，无法复制降AIGC后的全篇内容！</br>请购买智能降AIGC服务。"},"*");let t=e.find(".content").text();copyValue(t)});i(document).on("click",function(){parent.postMessage("documentClickEvent","*")})})(Report,jQuery);function updateFileNameAndPath(){let e=filename_reduce_ai=dirname_ai="";if(isOnlineView){e="ai";filename_reduce_ai="reduce_ai";dirname_ai="reduce_ai"}else{e="AIGC检测报告";filename_reduce_ai="降AIGC后的检测报告";dirname_ai="降AIGC"}$("a[data-type='降AIGC前报告']").attr("href",`../${e}.html`);$("a[data-type='降AIGC后报告']").attr("href",`../${dirname_ai}/${filename_reduce_ai}.html`)}function getReduceAiListInfo(i=0){return new Promise((e,t)=>{const a=document.createElement("script");a.src=`./js/reduceaigcpagelistdata${i}.js`;a.id=`reduceaigcpagelistdata`;document.body.appendChild(a);a.onload=()=>{e(reduceAiListInfo)};a.onerror=e=>{t(e)}})}function mergeSectionCount(e){let r=1;let o="<p>";$.each(e,function(e,{reduceAiFlag:t,sectionCount:a,content:i}){c=filterCharacter(i);if(a==r){o+=t=="0"?c:`<span class="green">${c}</span>`}else{r=a;o+=t=="0"?`</p>\r\n<p>${c}`:`</p>\r\n<p><span class="green">${c}</span>`}});o+="</p>";return o}function differResultHtml(e){let a="";$.each(e,function(e,t){if(t.added){a+=`<span class="add">${t.value.replace(/[\r\n]+/g,"<br/>")}</span>`}else if(t.removed){a+=`<span class="remove">${t.value.replace(/[\r\n]+/g,"<br/>")}</span>`}else{a+=`<span>${t.value.replace(/[\r\n]+/g,"<br/>")}</span>`}});return a}function scoreColor(e){if(e>=70){return"red"}else if(e>=60){return"orange"}else if(e>=50){return"purple"}}